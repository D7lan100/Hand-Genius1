{% extends 'base.html' %}

{% block title %}Donaciones{% endblock %}

{% block customCSS %}
<style>
  body {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    font-family: 'Segoe UI', Arial, sans-serif;
  }

  /* Card donaci√≥n */
  .donacion-card {
    background: linear-gradient(145deg, #ffffff, #f8f9fa);
    padding: 30px;
    border-radius: 20px;
    max-width: 500px;
    margin: 40px auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    border: 1px solid rgba(0,128,255,0.15);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .donacion-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 40px rgba(0,128,255,0.2);
  }

  /* Inputs */
  input, select {
    border-radius: 12px !important;
    padding: 12px !important;
    font-size: 16px !important;
    border: 1.5px solid #99CCFF !important;
    transition: all 0.3s ease;
  }
  input:focus, select:focus {
    border-color: #0080FF !important;
    box-shadow: 0 0 8px rgba(0,128,255,0.3);
  }

  /* Bot√≥n */
  .btn-donar {
    background: linear-gradient(135deg, #0080FF, #3399FF);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 30px;
    font-weight: 600;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(0,128,255,0.3);
  }
  .btn-donar:hover {
    background: linear-gradient(135deg, #0066CC, #2685E6);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,128,255,0.4);
  }

  /* Info pago */
  .info-pago {
    margin-top: 15px;
    background: #fff;
    border: 1px solid #99CCFF;
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,128,255,0.1);
  }

  /* Mensaje error */
  .mensaje-error {
    display: none;
    margin: 20px auto;
    padding: 15px;
    border-radius: 12px;
    background: linear-gradient(135deg, #FFBABA, #FF6B6B);
    color: white;
    font-weight: 600;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 8px 20px rgba(255,0,0,0.2);
  }
</style>
{% endblock %}

{% block content %}
<main class="container text-center my-5">
  <h3 class="fw-bold">Bienvenido a nuestro sistema de donaciones voluntarias</h3>
  <p class="text-muted">Tu apoyo nos ayuda a seguir creciendo üíô.</p>

  <!-- Formulario -->
  <div id="formularioDonacion" class="donacion-card">
    <h4 class="mb-3 text-primary fw-bold">Ap√≥yanos</h4>

    <label for="monto" class="form-label fw-semibold">Monto a aportar (COP):</label>
    <input type="number" id="monto" class="form-control" min="1000" step="1000" placeholder="Ej: 50000">

    <label for="metodo" class="form-label fw-semibold mt-3">M√©todo de pago:</label>
    <select id="metodo" class="form-select" onchange="mostrarInfoPago()">
      <option value=""> Selecciona</option>
      <option value="nequi">Nequi</option>
      <option value="daviplata">Daviplata</option>
      <option value="tarjeta">Tarjeta de Cr√©dito</option>
      <option value="paypal">PayPal</option>
    </select>

    <div id="infoPago" class="info-pago" style="display:none;"></div>

    <button class="btn-donar mt-3 w-100" onclick="procesarDonacion()">Confirmar donaci√≥n</button>
  </div>
</main>

<div id="mensajeError" class="mensaje-error">
  ‚ùå Ocurri√≥ un error al procesar la donaci√≥n. Int√©ntalo de nuevo.
</div>
{% endblock %}

{% block customJS %}
<script>
function mostrarInfoPago() {
  const metodo = document.getElementById("metodo").value;
  const infoDiv = document.getElementById("infoPago");
  infoDiv.style.display = "block";

  if (metodo === "nequi") {
    infoDiv.innerHTML = "<p>Transfiere tu donaci√≥n al n√∫mero Nequi: <b>300 123 4567</b></p>";
  } else if (metodo === "daviplata") {
    infoDiv.innerHTML = "<p>Transfiere tu donaci√≥n al n√∫mero Daviplata: <b>301 765 4321</b></p>";
  } else if (metodo === "tarjeta") {
    infoDiv.innerHTML = `
      <p>Ingresa los datos de tu tarjeta:</p>
      <input type="text" class="form-control mb-2" placeholder="N√∫mero de tarjeta (16 d√≠gitos)" maxlength="16">
      <input type="text" class="form-control mb-2" placeholder="MM/AA" maxlength="5">
      <input type="text" class="form-control" placeholder="CVV" maxlength="3">
    `;
  } else if (metodo === "paypal") {
    infoDiv.innerHTML = "<p>Ser√°s redirigido a PayPal para completar tu donaci√≥n.</p>";
  } else {
    infoDiv.style.display = "none";
  }
}

function procesarDonacion() {
  const monto = document.getElementById("monto").value;
  const metodo = document.getElementById("metodo").value;

  if (!monto || monto < 1000) {
    alert("Por favor ingresa un monto v√°lido (m√≠nimo $1.000).");
    return;
  }
  if (!metodo) {
    alert("Selecciona un m√©todo de pago.");
    return;
  }

  try {
    if (metodo === "paypal") {
      window.location.href = "https://www.paypal.com/donate";
    } else {
      alert("‚úÖ Donaci√≥n registrada por " + metodo + " de $" + monto);
    }
  } catch (error) {
    document.getElementById("mensajeError").style.display = "block";
  }
}
</script>
{% endblock %}
